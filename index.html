<!doctype html>
<html lang="en">
    <head>
        <title>CellFlux: Simulating Cellular Morphology Changes via Flow Matching</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon_io/favicon.png">

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Open Graph -->
        <meta property="og:url" content="https://yuhui-zh15.github.io/CellFlux/" />
        <meta property="og:image" content="https://yuhui-zh15.github.io/CellFlux/assets/0.png" />
        <meta property="og:title" content="CellFlux: Simulating Cellular Morphology Changes via Flow Matching" />
        <meta property="og:description" content="Building a virtual cell capable of accurately simulating cellular behaviors in silico has long been a dream in computational biology. We introduce CellFlux, an image-generative model that simulates cellular morphology changes induced by chemical and genetic perturbations using flow matching." />

        <!-- Twitter -->
        <meta name="twitter:url" content="https://yuhui-zh15.github.io/CellFlux/" />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:image" content="https://yuhui-zh15.github.io/CellFlux/assets/0.png" />
        <meta name="twitter:title" content="CellFlux: Simulating Cellular Morphology Changes via Flow Matching" />
        <meta name="twitter:description" content="Building a virtual cell capable of accurately simulating cellular behaviors in silico has long been a dream in computational biology. We introduce CellFlux, an image-generative model that simulates cellular morphology changes induced by chemical and genetic perturbations using flow matching." />

        <script src="./static/js/distill_template.v2.js"></script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="https://d3js.org/d3-collection.v1.min.js"></script>
        <script src="https://rawgit.com/nstrayer/slid3r/master/dist/slid3r.js"></script>

        <script defer="" src="./static/js/hider.js"></script>
        <script src="./static/js/image_interact.js"></script>
        <script src="./static/js/switch_videos.js"></script>

        <link rel="stylesheet" href="./static/css/style.css">
        <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>
        <script defer src="./static/js/fontawesome.all.min.js"></script>

        <!-- medium zoom https://github.com/francoischalifour/medium-zoom -->
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>  <!-- jquery -->
        <script defer src="./static/js/medium-zoom.min.js"></script>
        <script defer src="./static/js/zoom.js"></script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-WLB3DPRW48"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-WLB3DPRW48');
        </script>
    </head>
    <body>
        <div class="header-wrapper">
            <div class="header-container" id="header-container">
                <div class="header-content">
                    <h1 style="margin-top: 0px; font-size: 2.5rem;"><i>CellFlux:</i></h1>
                    <h2 class="responsive-subtitle">Simulating Cellular Morphology Changes via <i>Flow Matching</i></h2>
                        <p style="font-size: 1.2rem; line-height: 1.6; margin: 1.5rem 0;">
                            Building a virtual cell capable of accurately simulating cellular behaviors in silico has long been a dream in computational biology. 
                            We introduce <em><strong>CellFlux</strong></em>, an image-generative model that simulates cellular morphology changes 
                            induced by chemical and genetic perturbations using flow matching.
                        </p>

                        <div class="icon-container" style="justify-content: flex-start; text-align: left; margin: 2rem 0;">
                            <div class="icon-item" style="text-align: left;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem; margin-right: 0.5rem;">üîÆ </div>
                                <div style="font-size: 1.05rem;"><strong>Method Overview</strong>: Predict changes in cell morphology induced by chemical or gene perturbations through distribution-to-distribution modeling using flow matching.</div>
                            </div>
                            <div class="icon-item" style="text-align: left;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem; margin-right: 0.5rem;">üí° </div>
                                <div style="font-size: 1.05rem;"><strong>Key Innovation</strong>: Formulate cellular morphology prediction as a distribution-to-distribution learning problem, distinguishing true perturbation effects from experimental artifacts.</div>
                            </div>
                            <div class="icon-item" style="text-align: left;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem; margin-right: 0.5rem;">üõ†Ô∏è </div>
                                <div style="font-size: 1.05rem;"><strong>Algorithm Details</strong>: Employ flow matching to learn continuous transformations with conditional flow matching, classifier-free guidance, and U-Net architecture.</div>
                            </div>
                            <div class="icon-item" style="text-align: left;">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem; margin-right: 0.5rem;">üíé </div>
                                <div style="font-size: 1.05rem;"><strong>Results & Capabilities</strong>: Achieve 35% improvement in FID scores and 12% increase in prediction accuracy with novel trajectory modeling capabilities.</div>
                            </div>
                        </div>

                    <div class="button-container" style="justify-content: flex-start; margin: 2rem 0;">
                        <a href="https://arxiv.org/abs/2502.09775" class="button paper-link" target="_blank">
                            <span class="icon is-small">
                                <i class="ai ai-arxiv"></i>
                            </span>
                            arXiv
                        </a>
                        <a href="https://arxiv.org/pdf/2502.09775" class="button paper-link" target="_blank">
                            <span class="icon is-small">
                                <i class="fas fa-file-pdf"></i>
                            </span>
                            <span>pdf</span>
                        </a>
                        <a href="https://github.com/yuhui-zh15/CellFlux" class="button" target="_blank">
                            <span class="icon is-small">
                                <i class="fab fa-github"></i>
                            </span>
                            <span>Code</span>
                        </a>
                    </div>
                </div>
                <div class="header-image">
                    <img draggable="false" src="assets/0.png" alt="CellFlux Overview" class="teaser-image" style="width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
                </div>
            </div>
        </div>
    <d-article>
        <div class="byline">
            <div class="byline-container">
                <p>
                    <a href="https://cs.stanford.edu/~yuhuiz/" class="author-link" target="_blank">Yuhui Zhang<sup>1,*</sup></a> &emsp;
                    <a href="https://suyccc.github.io/" class="author-link" target="_blank">Yuchang Su<sup>2,*</sup></a> &emsp;
                    <a href="https://chenyuwang-monica.github.io/" class="author-link" target="_blank">Chenyu Wang<sup>3</sup></a> &emsp;
                    <a href="https://www.tianhongli.me/" class="author-link" target="_blank">Tianhong Li<sup>1</sup></a> &emsp;
                    <a href="https://scholar.google.com/citations?user=0XwkyyEAAAAJ&hl=en" class="author-link" target="_blank">Zoe Wefers<sup>1</sup></a> &emsp;
                    <a href="https://scholar.google.com/citations?user=AJJwTxoAAAAJ&hl=en" class="author-link" target="_blank">Jeffrey Nirschl<sup>1</sup></a> &emsp;
                    <a href="https://jmhb0.github.io/" class="author-link" target="_blank">James Burgess<sup>1</sup></a> &emsp;
                    <a href="https://scholar.google.com/citations?user=O2HUmYsAAAAJ&hl=en" class="author-link" target="_blank">Daisy Ding<sup>1</sup></a> &emsp;
                    <a href="https://ale9806.github.io/alejandrolozano/" class="author-link" target="_blank">Alejandro Lozano<sup>1</sup></a> &emsp;
                    <a href="https://lundberglab.stanford.edu/" class="author-link" target="_blank">Emma Lundberg<sup>1</sup></a> &emsp;
                    <a href="https://ai.stanford.edu/~syyeung/" class="author-link" target="_blank">Serena Yeung-Levy<sup>1</sup></a>
                    <p></p>
                </p>
                <div style="text-align: center;">
                    <a href="https://stanford.edu/" class="affiliation-link" target="_blank"><sup>1</sup>Stanford University</a> &emsp;
                    <a href="https://www.tsinghua.edu.cn/" class="affiliation-link" target="_blank"><sup>2</sup>Tsinghua University</a> &emsp;
                    <a href="https://mit.edu/" class="affiliation-link" target="_blank"><sup>3</sup>MIT</a>
                </div>
                <p style="text-align: center; font-size: 1.35em; color: red; font-weight: bold;">
                    <a href="#" target="_blank">ICML 2025</a>
                </p>
                <p style="text-align: center; margin-bottom: 0;">
                    <span class="author-note"><sup>*</sup>Equal contribution</span>
                </p>
            </div>
        </div>

        <p class="text abstract">
            Building a virtual cell capable of accurately simulating cellular behaviors in silico has long been a dream in computational biology. 
            We introduce CellFlux, an image-generative model that simulates cellular morphology changes induced by chemical and genetic perturbations using flow matching. 
            Unlike prior methods, CellFlux models distribution-wise transformations from unperturbed to perturbed cell states, effectively distinguishing actual perturbation effects from experimental artifacts such as batch effects‚Äîa major challenge in biological data.

            <br><br>
            When evaluated on chemical (BBBC021), genetic (RxRx1), and combined perturbation (JUMP) datasets, CellFlux generates biologically meaningful cell images that faithfully capture perturbation-specific morphological changes, achieving a <strong>35% improvement in FID scores</strong> and a <strong>12% increase in mode-of-action prediction accuracy</strong> over existing methods. Additionally, CellFlux enables continuous interpolation between cellular states, providing a potential tool for studying perturbation dynamics. These capabilities mark a significant step toward realizing virtual cell modeling for biomedical research.
        </p>

        <div class="icon-row">
            <a href="#overview" class="icon-link">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üîÆ</div>
                Method<br>Overview
            </a>
            <a href="#innovation" class="icon-link">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üí°</div>
                Key<br>Innovation
            </a>
            <a href="#methods" class="icon-link">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üõ†Ô∏è</div>
                Algorithm<br>Details
            </a>
            <a href="#capabilities" class="icon-link">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üíé</div>
                Results &amp;<br>Capabilities
            </a>
        </div>

        <p class="click-hint" style="width: 85%;">
            <img src="static/img/icons/click.gif" style="width: 1.5rem">
            <strong>Click to jump to each section.</strong>
        </p>

        <p class="text abstract">
            Our method represents a significant advancement in computational biology, providing researchers with powerful tools for <strong>virtual cell modeling</strong>, <strong>drug discovery</strong>, and <strong>understanding cellular dynamics</strong>. The open-source implementation enables the community to build upon this work and accelerate progress in this field.
        </p>

        <hr>

        <div id='overview' class="vision-block">
            <h1 class="text">üîÆ Method Overview</h1>
            
            <p class="text">
                Our method aims to predict changes in cell morphology induced by chemical or gene perturbations in silico. 
                The approach addresses the fundamental challenge of distinguishing true biological effects from experimental artifacts 
                through innovative distribution-to-distribution modeling.
            </p>

            <d-figure id="fig-overview">
                <figure>
                    <img data-zoomable="" draggable="false" src="assets/1.png" alt="CellFlux Overview">
                    <figcaption>
                        <strong>Figure 1:</strong> Method overview.
                        <strong>(a)</strong> Objective: Predict morphological changes from perturbations.
                        <strong>(b)</strong> Data: High-content screening with control and perturbed wells.
                        <strong>(c)</strong> Problem formulation: Distribution-to-distribution transformation.
                        <strong>(d)</strong> Flow matching: Learning velocity fields for continuous transformation.
                        <strong>(e)</strong> Results: Superior performance in generation quality and biological accuracy.
                    </figcaption>
                </figure>
            </d-figure>

            <p class="text">
                Key components of CellFlux include:
            </p>
            <ul class="text">
              <li><strong>Objective.</strong> Predict changes in cell morphology induced by chemical or gene perturbations in silico. In this example, the perturbation effect reduces the nuclear size.</li>
              <li><strong>Data.</strong> The dataset includes images from high-content screening experiments, where chemical or genetic perturbations are applied to target wells, alongside control wells without perturbations. Control wells provide prior information that contrasts with target images, enabling the identification of true perturbation effects (e.g., reduced nucleus size) while calibrating non-perturbation artifacts such as batch effects‚Äîsystematic biases unrelated to the perturbation (e.g., variations in color intensity).</li>
              <li><strong>Problem formulation.</strong> We formulate the task as a distribution-to-distribution problem (many-to-many mapping), where the source distribution consists of control images, and the target distribution contains perturbed images within the same batch.</li>
              <li><strong>Flow matching.</strong> Our method employs flow matching, a state-of-the-art generative approach for distribution-to-distribution problems. It learns a neural network to approximate a velocity field, continuously transforming the source distribution into the target by solving an ordinary differential equation (ODE).</li>
              <li><strong>Results.</strong> The method significantly outperforms baselines in image generation quality, achieving lower Fr√©chet Inception Distance (FID) and higher classification accuracy for mode-of-action (MoA) predictions.</li>
        </div>

        <div id='innovation' class="connector-block">
            <h1 class="text">üí° Key Innovation: Distribution-to-Distribution Transformation</h1>
            
            <p class="text">
                Our key innovation lies in formulating cellular morphology prediction as a <strong>distribution-to-distribution learning problem</strong>. 
                Traditional methods often ignore control cells or treat perturbation prediction as a simple image-to-image translation. 
                In contrast, our approach recognizes that:
            </p>

            <div class="subsection">
                <ul class="text">
                    <li><strong>Control cells provide crucial context.</strong> They serve as a reference to distinguish true perturbation effects from experimental artifacts like batch effects.</li>
                    <li><strong>Batch effects are systematic biases.</strong> Variations in experimental conditions across different runs introduce consistent biases unrelated to the perturbation itself.</li>
                    <li><strong>Distribution-wise modeling is more robust.</strong> By learning transformations between entire distributions rather than individual images, our method captures the inherent variability in biological systems.</li>
                </ul>
                
                <p class="text">
                    This approach enables our method to generate more accurate and biologically meaningful cellular responses while maintaining robustness across diverse experimental conditions.
                </p>
            </div>
        </div>

        <div id='methods' class="data-block">
            <h1 class="text">üõ†Ô∏è Algorithm Details</h1>
            
            <p class="text">
                Our method leverages flow matching to learn continuous transformations between cellular states. 
                The algorithm is designed to handle the complexity of biological data while maintaining computational efficiency.
            </p>

            <d-figure id="fig-methods">
                <figure>
                    <img data-zoomable="" draggable="false" src="assets/2.png" alt="CellFlux Algorithm Overview">
                    <figcaption>
                        <strong>Figure 2:</strong> Algorithm overview. Our method leverages flow matching to learn continuous transformations between cellular states.
                    </figcaption>
                </figure>
            </d-figure>

            <div class="subsection">
                <h3 class="text">Training Process</h3>
                <p class="text">
                    During training, our model learns a velocity field by fitting trajectories between control cell images (x‚ÇÄ ~ p‚ÇÄ) and perturbed cell images (x‚ÇÅ ~ p‚ÇÅ). 
                    At each training step, intermediate states are sampled along linear interpolations, and the network minimizes the difference between predicted and true velocities.
                </p>
            </div>

            <div class="subsection">
                <h3 class="text">Inference Process</h3>
                <p class="text">
                    At inference, the trained velocity field guides the transformation of control cell states into perturbed states by solving an ordinary differential equation iteratively using numerical integration steps.
                </p>
            </div>

            <div class="subsection">
              <p class="text">
                Key Technical Components include:
              </p>
                <ul class="text">
                    <li><strong>Conditional Flow Matching:</strong> Extends flow matching to handle perturbation conditions.</li>
                    <li><strong>Classifier-Free Guidance:</strong> Improves generation fidelity through conditional/unconditional interpolation.</li>
                    <li><strong>Noise Augmentation:</strong> Prevents overfitting and encourages smooth velocity fields.</li>
                    <li><strong>U-Net Architecture:</strong> Captures multi-scale features for accurate cellular morphology modeling.</li>
                </ul>
            </div>
        </div>

        <div id='capabilities' class="sota-block">
            <h1 class="text">üíé Results & Capabilities</h1>
            
            <div class="subsection">
                <h3 class="text">State-of-the-Art Performance</h3>
                <p class="text">
                    Our method achieves superior performance across multiple cellular imaging datasets, demonstrating significant improvements in both image generation quality and biological relevance.
                </p>

                <d-figure id="fig-results1">
                    <figure>
                        <img data-zoomable="" draggable="false" src="assets/3.png" alt="CellFlux Performance Results">
                        <figcaption>
                            <strong>Figure 3:</strong> State-of-the-art performance across multiple datasets. Our method consistently outperforms baseline methods.
                        </figcaption>
                        </figure>
                </d-figure>

                <d-figure id="fig-results2">
                    <figure>
                        <img data-zoomable="" draggable="false" src="assets/4.png" alt="Detailed Performance Metrics">
                        <figcaption>
                            <strong>Figure 4:</strong> Qualitative results showing our method generates the most biologically accurate and faithful images in various settings.
                        </figcaption>
                    </figure>
                </d-figure>

                <p class="text">
                    Our results demonstrate significant improvements:
                </p>
                <ul class="text">
                    <li><strong>35%</strong> improvement in FID scores compared to existing methods</li>
                    <li><strong>12%</strong> increase in mode-of-action prediction accuracy</li>
                    <li><strong>Strong out-of-distribution generalization</strong> to unseen perturbations</li>
                </ul>
            </div>

            <div class="subsection">
                <h3 class="text">Novel Capabilities</h3>
                <p class="text">
                    Our method unlocks unprecedented capabilities that advance the field toward a true virtual cell, 
                    enabling researchers to study cellular dynamics in ways previously impossible.
                </p>

                <d-figure id="fig-interpolation">
                    <figure>
                        <img data-zoomable="" draggable="false" src="assets/5.png" alt="Continuous Interpolation Capabilities">
                        <figcaption>
                            <strong>Figure 5:</strong> Novel capabilities including batch effects calibration and modeling bidirectional cellular morphological change trajectories.
                        </figcaption>
                    </figure>
                </d-figure>

                <p class="text">
                    Key capabilities include:
                </p>
                <ul class="text">
                    <li><strong>Batch Effect Calibration:</strong> Distinguishes true biological effects from experimental artifacts.</li>
                    <li><strong>Trajectory Modeling:</strong> Provides insights into the dynamics of cellular responses.</li>
                    <li><strong>Bidirectional Transformations:</strong> Can model both forward perturbation and recovery dynamics.</li>
                </ul>

                <p class="text">
                    These capabilities advance our understanding of cellular behavior and provide powerful tools for drug discovery and personalized therapy development.
                </p>
            </div>
        </div>

        <div id="conclusion" style="position: relative; margin-top: 40px; margin-bottom: 0px;">
            <h2 class="text" style="margin-top:0px; margin-bottom:10px">Conclusion</h2>
            <p class="text">
                Our method represents a significant advancement in computational biology, providing researchers with powerful tools for virtual cell modeling, drug discovery, and understanding cellular dynamics. The distribution-to-distribution approach addresses fundamental challenges in biological data analysis, while flow matching enables unprecedented capabilities in cellular morphology simulation. We hope our work will strengthen the computational biology community and accelerate progress toward truly predictive virtual cell models.
            </p>
        </div>

        </d-article>
        <d-appendix>
            <h3>BibTeX</h3>
            <p class="bibtex">
                @inproceedings{CellFlux,<br>
                &nbsp;&nbsp;title={{CellFlux: Simulating Cellular Morphology Changes via Flow Matching}},<br>
                &nbsp;&nbsp;author={Zhang, Yuhui and Su, Yuchang and Wang, Chenyu and Li, Tianhong and Wefers, Zoe and Nirschl, Jeffrey and Burgess, James and Ding, Daisy and Lozano, Alejandro and Lundberg, Emma and Yeung-Levy, Serena},<br>
                &nbsp;&nbsp;booktitle={International Conference on Machine Learning (ICML)},<br>
                &nbsp;&nbsp;year={2025}<br>
                }
            </p>

            <h3>Acknowledgments</h3>
            <p style="color: gray; font-size: 0.9em;">
                We thank Cambrian for generously providing this elegant project page template, which is available at <a href="https://github.com/cambrian-mllm/cambrian-mllm.github.io" target="_blank" style="color: gray;">here</a>.
            </p>

            <d-footnote-list></d-footnote-list>
            <d-citation-list></d-citation-list>
        </d-appendix>
        <script src="./static/js/nav-bar.js"></script>
    </body>
</html>